import json
from flask import Flask, render_template_string, request

app = Flask(__name__)

# --- 1. DATA: 69 Wilayas of Algeria ---
WILAYAS = {
    "1":"ุฃุฏุฑุงุฑ", "2":"ุงูุดูู", "3":"ุงูุฃุบูุงุท", "4":"ุฃู ุงูุจูุงูู", "5":"ุจุงุชูุฉ", "6":"ุจุฌุงูุฉ", "7":"ุจุณูุฑุฉ", "8":"ุจุดุงุฑ", "9":"ุงูุจููุฏุฉ", "10":"ุงูุจููุฑุฉ",
    "11":"ุชููุฑุงุณุช", "12":"ุชุจุณุฉ", "13":"ุชููุณุงู", "14":"ุชูุงุฑุช", "15":"ุชูุฒู ูุฒู", "16":"ุงูุฌุฒุงุฆุฑ", "17":"ุงูุฌููุฉ", "18":"ุฌูุฌู", "19":"ุณุทูู", "20":"ุณุนูุฏุฉ",
    "21":"ุณูููุฏุฉ", "22":"ุณูุฏู ุจูุนุจุงุณ", "23":"ุนูุงุจุฉ", "24":"ูุงููุฉ", "25":"ูุณูุทููุฉ", "26":"ุงููุฏูุฉ", "27":"ูุณุชุบุงูู", "28":"ุงููุณููุฉ", "29":"ูุนุณูุฑ", "30":"ูุฑููุฉ",
    "31":"ููุฑุงู", "32":"ุงูุจูุถ", "33":"ุฅููุฒู", "34":"ุจุฑุฌ ุจูุนุฑูุฑูุฌ", "35":"ุจููุฑุฏุงุณ", "36":"ุงูุทุงุฑู", "37":"ุชูุฏูู", "38":"ุชูุณูุณููุช", "39":"ุงููุงุฏู", "40":"ุฎูุดูุฉ",
    "41":"ุณูู ุฃูุฑุงุณ", "42":"ุชูุจุงุฒุฉ", "43":"ูููุฉ", "44":"ุนูู ุงูุฏููู", "45":"ุงููุนุงูุฉ", "46":"ุนูู ุชููุดูุช", "47":"ุบุฑุฏุงูุฉ", "48":"ุบููุฒุงู", "49":"ุชูููููู", "50":"ุจุฑุฌ ุจุงุฌู ูุฎุชุงุฑ",
    "51":"ุฃููุงุฏ ุฌูุงู", "52":"ุจูู ุนุจุงุณ", "53":"ุนูู ุตุงูุญ", "54":"ุนูู ูุฒุงู", "55":"ุชูุฑุช", "56":"ุฌุงูุช", "57":"ุงููุบูุฑ", "58":"ุงููููุนุฉ",
    "59":"ุขููู", "60":"ุงูุงุจูุถ ุณูุฏู ุงูุดูุฎ", "61":"ุงูุนุฑูุดุฉ", "62":"ุงูููุทุฑุฉ", "63":"ุจุฑููุฉ", "64":"ุจูุณุนุงุฏุฉ", "65":"ุจุฆุฑ ุงูุนุงุชุฑ", "66":"ูุตุฑ ุงูุจุฎุงุฑู", "67":"ูุตุฑ ุงูุดูุงูุฉ", "68":"ุนูู ูุณุงุฑุฉ", "69":"ูุณุนุฏ"
}

# --- 2. DATA: HARDCODED COMMUNES (Compressed for Reliability) ---
# Format: "WilayaCode": "Commune1,Commune2,Commune3..."
RAW_COMMUNES = {
    "1": "ุฃุฏุฑุงุฑ,ุชุงูุณุช,ุดุงุฑููู,ุฑูุงู,ุฅู ุฒุบููุฑ,ุชูุช,ูุตุฑ ูุฏูุฑ,ุชุณabit,ุฃูุจูู,ุฃููู,ุชูููุชู,ูููุบูู,ุฒุงููุฉ ููุชุฉ,ุจูุฏุฉ,ุฃูุฒุฌููุฑ",
    "2": "ุงูุดูู,ุชูุณ,ุจูุงูุฑูุฉ,ุงููุฑูููุฉ,ุชุงููุฑูุช,ุจูู ุญูุงุก,ุงูุตุจุญุฉ,ููุฒู,ุงููุงุฏู,ุงููุงุฏ ูุงุฑุณ,ุงูุดุทูุฉ,ุงูุงุจูุถ ูุฌุงุฌุฉ,ุงููุงุฏ ุจู ุนุจุฏ ุงููุงุฏุฑ,ุชุงุฌูุฉ,ุงูุธูุฑุฉ,ุงููุฑุณู,ุงูุญุฌุงุฌ,ุณูุฏู ุนูุงุดุฉ,ุณูุฏู ุนุจุฏ ุงูุฑุญูู,ุจูู ุฑุงุดุฏ,ูุตุฏู,ุณูุฏู ูุนุฑูู,ุงู ุงูุฏุฑูุน",
    "3": "ุงูุฃุบูุงุท,ูุตุฑ ุงูุญูุฑุงู,ุจู ูุงุตุฑ ุจู ุดูุฑุฉ,ุณูุฏู ูุฎููู,ุญุงุณู ุงูุฏูุงุนุฉ,ุญุงุณู ุงูุฑูู,ุนูู ูุงุถู,ุชุงุฌุฑููุฉ,ุงูุฎูู,ุงูููุชุฉ,ุจุฑูุฏุฉ,ุงูุบูุดุฉ,ุงูุญููุทุฉ,ูุงุฏู ูุฑุฉ,ูุงุฏู ูุฒู",
    "4": "ุฃู ุงูุจูุงูู,ุนูู ุงูุจูุถุงุก,ุนูู ููููุฉ,ุนูู ููุฑูู,ุนูู ุจุจูุด,ุจุฑูุด,ุจูุบุฑุงุฑุฉ ุณุนูุฏู,ุจุฆุฑ ุงูุดูุฏุงุก,ุฏูุงูุฉ,ุงูุถูุนุฉ,ููุฑููุฉ,ููุดูุฑ ุชููุบูู,ุงูุฌุงุฒูุฉ,ูุณููุงูุฉ,ูุงุฏ ูููู,ุฃููุงุฏ ูุงุณู,ุฃููุงุฏ ุญููุฉ,ุฃููุงุฏ ุฒูุงู,ุงูุฑุญูุฉ,ุณูููุณ,ุณูู ูุนูุงู,ุงูุฒุฑู",
    "5": "ุจุงุชูุฉ,ุจุฑููุฉ,ุนูู ุงูุชูุชุฉ,ูุฑูุงูุฉ,ููุงูุณ,ุชุงุฒููุช,ุฃุฑูุณ,ุนูู ุฌุงุณุฑ,ุงูุฌุฒุงุฑ,ุณุฑูุงูุฉ,ููุนุฉ,ุงููุนุฐุฑ,ุชูููุงุฏ,ุฑุงุณ ุงูุนููู,ูุงุฏู ุงููุงุก,ุงููุงุฏ ุณู ุณูููุงู,ุชููุช,ุฅูููุบูุณู,ุงูุดูุฑุฉ,ุชููุงุทู,ุนููู ุงูุนุตุงููุฑ,ูุณุฏูุณ,ูุงุฏู ุงูุดุนุจุฉ,ุชุงูุฎูุช",
    "6": "ุจุฌุงูุฉ,ุฃูุจู,ุฃููุฒูุฑ,ุฎุฑุงุทุฉ,ุณูุฏู ุนูุด,ุตุฏูู,ุชููุฒุฑูุช,ุณูู ุงูุฅุซููู,ุชูุฌุฉ,ุจุฑุจุงุดุฉ,ุงููุตุฑ,ุฃููุงุณ,ุฐุฑุงุน ุงููุงูุฏ,ููุฏูุฑุฉ,ุจูู ูุนูุด,ุดูููู,ุฃุฏูุงุฑ,ุชูุดู,ุณูุนูู,ุขูุซ ุฅุณูุงุนูู",
    "7": "ุจุณูุฑุฉ,ุฃููุงุฏ ุฌูุงู,ุณูุฏู ุนูุจุฉ,ูุดููุด,ุงูููุทุฑุฉ,ุงููุทุงูุฉ,ุฌููุฑุฉ,ุนูู ุฒุนุทูุท,ุงูุจุฑุงููุณ,ุฌููุฑุฉ,ุฒุฑูุจุฉ ุงููุงุฏู,ุงููุฒูุฑุนุฉ,ุจูุดูุฑูู,ููุดุงูุฉ,ุทูููุฉ,ุฃูุฑูุงู,ุฃููุงุด,ููููู",
    "8": "ุจุดุงุฑ,ุงูุนุจุงุฏูุฉ,ุงูููุงุฏุณุฉ,ุจูู ูููู,ุชุจูุจุงูุฉ,ุชุงุบูุช,ูุญูุฑ,ูุฑูุฌุฉ,ุนุฑู ูุฑุงุฌ,ุจููุงูุณ",
    "9": "ุงูุจููุฏุฉ,ุจููุงุฑูู,ุงูุฃุฑุจุนุงุก,ุงูุดูุฉ,ููุฒุงูุฉ,ุงูุนูุฑูู,ูุงุฏู ุงูุนูุงูู,ุญูุงู ูููุงู,ุจููุฑุฉ,ุฃููุงุฏ ูุนูุด,ุดุฑูุนุฉ,ุจู ุฎููู,ุตููุนุฉ,ูุฑูุงู,ุจูุนุฑูุฉ,ุนูู ุงูุฑูุงูุฉ,ุฌุจุงุจุฑุฉ",
    "10": "ุงูุจููุฑุฉ,ุงูุฃุฎุถุฑูุฉ,ุณูุฑ ุงูุบุฒูุงู,ุนูู ุจุณุงู,ุจุดููู,ูุดุฏุงูุฉ,ุงููุงุฏุฑูุฉ,ุจุฆุฑ ุบุจุงูู,ุงููุงุดููุฉ,ุญูุฒุฑ,ุชุงุบุฒูุช,ุงูุช ูุนุฒูุฒ,ุนูุฑ,ุงูุฌุจุงุฌุจูุฉ,ุณูู ุงูุฎููุณ,ุงูููุฑุงูู,ุงูุฃุณูุงู",
    "11": "ุชููุฑุงุณุช,ุฃุจุงูุณุฉ,ุฅุฏูุณ,ุชุงุธุฑูู,ุนูู ุฃููู",
    "12": "ุชุจุณุฉ,ุงูุดุฑูุนุฉ,ุจุฆุฑ ุงูุนุงุชุฑ,ุงูููุฒุฉ,ุงูุนููุฉ,ุงููุฑูุฌ,ุจููุญุงู ุงูุฏูุฑ,ุงููููู,ูุฑุณุท,ุงูุนูููุงุช,ุจูุฎุถุฑุฉ,ุงูุญูุงูุงุช,ููุฑูู,ูุฑูุงู,ุตูุตุงู ุงููุณุฑุฉ,ุจุฆุฑ ููุฏู",
    "13": "ุชููุณุงู,ูุบููุฉ,ููุตูุฑุฉ,ุดุชูุฉ,ุดุชูุงู,ูุฏุฑููุฉ,ุงูุบุฒูุงุช,ุณุจุฏู,ุงูุญูุงูุฉ,ุฃููุงุฏ ููููู,ุงูุฑูุดู,ุจูู ุณููุณ,ุณูุฏู ุงูุฌููุงูู,ุจุงุจ ุงูุนุณุฉ,ููุงูุณู,ุนูู ุชุงููุช,ุจูู ุตุงู,ูุฑุณู ุจู ูููุฏู",
    "14": "ุชูุงุฑุช,ุงูุณููุฑ,ูุฑูุฏุฉ,ูุตุฑ ุงูุดูุงูุฉ,ููุฏูุฉ,ุฑุญููุฉ,ุงูุฏุญูููู,ุนูู ูุฑูุณ,ูุฏุฑูุณุฉ,ุญูุงุฏูุฉ,ูุงุฏ ูููู,ูุดุฑุน ุงูุตูุง,ุชุฎูุฑุช,ุนูู ุงูุฐูุจ,ุดุญููุฉ,ูุฑุทููุฉ",
    "15": "ุชูุฒู ูุฒู,ุฐุฑุงุน ุจู ุฎุฏุฉ,ุนุฒุงุฒูุฉ,ุงูุฃุฑุจุนุงุก ูุงุซ ุฅูุฑุงุซู,ุฐุฑุงุน ุงูููุฒุงู,ุชูุฒู ุบููู,ุจูุฒุบู,ุนูู ุงูุญูุงู,ูุงุถูุฉ,ุฃุจู ููุณู,ุฃุฒููู,ุชููุฒูุฑุช,ุฅูุฑุญููู,ุจูู ููู,ูุดุทุฑุงุณ,ุจูุบูู,ูุนุงุชูุฉ,ูุฑูุญุฉ,ุชูููุฒุงุฑ",
    "16": "ุงูุฌุฒุงุฆุฑ ุงููุณุทู,ุณูุฏู ุงูุญูุฏ,ุงููุฏููุฉ,ุงูุญุงูุฉ,ุจุงุจ ุงููุงุฏู,ุงููุตุจุฉ,ุจูููุบูู,ุฑุงูุณ ุญููุฏู,ูุงุฏู ูุฑูุด,ุงูุฃุจูุงุฑ,ุจู ุนูููู,ุจูู ูุณูุณ,ุจูุฒุฑูุนุฉ,ุงูุญุฑุงุด,ุจูุฑูุจุฉ,ูุงุฏู ุงูุณูุงุฑ,ุจุงุด ุฌุฑุงุญ,ุญุณูู ุฏุงู,ุงููุจุฉ,ุจุฆุฑ ูุฑุงุฏ ุฑุงูุณ,ุญูุฏุฑุฉ,ุงููุญูุฏูุฉ,ุงูุฏุงุฑ ุงูุจูุถุงุก,ุจุงุจ ุงูุฒูุงุฑ,ุจุฑุฌ ุงููููุงู,ุจุฑุฌ ุงูุจุญุฑู,ุงููุฑุณู,ุนูู ุทุงูุฉ,ูุฑุงูุฉ,ุฑููุจุฉ,ุฑุบุงูุฉ,ุนูู ุทุงูุฉ,ุจุฆุฑ ุฎุงุฏู,ุฌุณุฑ ูุณูุทููุฉ,ุงูุณุญุงููุฉ,ุจุฆุฑ ุชูุชุฉ,ุชุณุงูุฉ ุงููุฑุฌุฉ,ุฃููุงุฏ ุดุจู,ุฒุฑุงูุฏุฉ,ุณุทุงูุงูู,ุณูุฏุงููุฉ,ูุนุงููุฉ,ุงูุฑุญูุงููุฉ,ุฏุฑุงุฑูุฉ,ุงูุนุงุดูุฑ,ุจุงุจุง ุญุณู,ุฎุฑุงูุณูุฉ,ุฏูููุฑุฉ",
    "17": "ุงูุฌููุฉ,ุนูู ูุณุงุฑุฉ,ูุณุนุฏ,ุญุงุณู ุจุญุจุญ,ุฏุงุฑ ุงูุดููุฎ,ุงูุดุงุฑู,ุงูุฅุฏุฑูุณูุฉ,ุงูุจูุฑูู,ุณูุฏู ูุนุฌุงู,ุญุฏ ุงูุตุญุงุฑู,ููุถ ุงูุจุทูุฉ,ุงููุฌุจุงุฑุฉ,ุนูู ุงูุฅุจู,ูุทุงุฑุฉ,ุฏูุฏูู,ุชุนุธููุช",
    "18": "ุฌูุฌู,ุงูุทุงููุฑ,ุงูููููุฉ,ุงูุนูุตุฑ,ุงูุฌูุนุฉ ุจูู ุญุจูุจู,ุงูุดููุฉ,ุงูุนูุงูุฉ,ุฒูุงูุฉ ููุตูุฑูุฉ,ุณูุฏู ุนุจุฏ ุงูุนุฒูุฒ,ูุงูู,ุจูุฑุงูู ุจููุงุฏู,ูุฌุงูุฉ,ุณุทุงุฑุฉ,ุฌูููุฉ,ุฅูุฑุงูู ุณููุณู",
    "19": "ุณุทูู,ุงูุนููุฉ,ุนูู ูููุงู,ุนูู ุฃุฑูุงุช,ุนูู ุขุฒุงู,ุนูู ุงููุจูุฑุฉ,ุจููุงุนุฉ,ุฌูููุฉ,ุตุงูุญ ุจุงู,ุนููุดุฉ,ุจูู ุนุฒูุฒ,ุจุงุจูุฑ,ุญููุงู ุงูุณุฎูุฉ,ูุงูููุงู,ุนูู ุงูุณุจุช,ุฐุฑุงุน ูุงุฆุฏ,ุชุงูุฉ ุฅููุงุณู",
    "20": "ุณุนูุฏุฉ,ุนูู ุงูุญุฌุฑ,ููุจ,ุณูุฏู ุจูุจูุฑ,ุฃููุงุฏ ุฅุจุฑุงููู,ุงูุญุณุงุณูุฉ,ูููุงู ูุนุฑุจู,ุณูุฏู ุนูุงุฑ,ุนูู ุงูุณูุทุงู,ุชูุฑุณูู,ูููุช",
    "21": "ุณูููุฏุฉ,ุงููู,ุนุฒุงุจุฉ,ุงูุญุฑูุด,ุชูุงููุณ,ุฑูุถุงู ุฌูุงู,ุจู ุนุฒูุฒ,ุนูู ูุดุฑุฉ,ุฃู ุงูุทูุจ,ุงูุญุฏุงุฆู,ุญูุงุฏู ูุฑููุฉ,ููููุฉ,ุจูู ุฒูุฏ,ุงูุฒูุชููุฉ,ูุฑูุฑุฉ,ุจูู ุจุดูุฑ",
    "22": "ุณูุฏู ุจูุนุจุงุณ,ุณููุฒู,ุจู ุจุงุฏูุณ,ุชูุงุบ,ุชููุฑุฉ,ุฑุฃุณ ุงููุงุก,ุนูู ุงูุจุฑุฏ,ุณูุฏู ูุญุณู,ุณูุฏู ุนูู ุจูุณูุฏู,ูุฑุญูู,ูููุงู ุณููุณู,ุจูุฎูููุณ,ุชุณุงูุฉ,ูุตุทูู ุจู ุงุจุฑุงููู,ุณูุฏู ุงุจุฑุงููู",
    "23": "ุนูุงุจุฉ,ุงูุจููู,ุงูุญุฌุงุฑ,ุณูุฏู ุนูุงุฑ,ุจุฑุญุงู,ุงูุชุฑูุนุงุช,ุงูุนููุฉ,ุงูุดุฑูุฉ,ูุงุฏ ุงูุนูุจ,ุณุฑุงูุฏู,ุดุทุงูุจู",
    "24": "ูุงููุฉ,ูุงุฏู ุงูุฒูุงุชู,ูููููุจูููุณ,ุจูุดููู,ุนูู ูุฎููู,ุญูุงู ุฏุจุงุบ,ูุฎุฒุงุฑุฉ,ุจูููุฑุฉ ุฃุญูุฏ,ุจูุฎูุฑ,ุนูู ุงูุนุฑุจู,ุชุงููููุฉ,ุงูุฑูููุฉ,ุณูุงูุฉ ุนูููุฉ,ุนูู ุฑูุงุฏุฉ,ุจูุญุดุงูุฉ",
    "25": "ูุณูุทููุฉ,ุงูุฎุฑูุจ,ุญุงูุฉ ุจูุฒูุงู,ุนูู ุณูุงุฑุฉ,ุฒูุบูุฏ ููุณู,ุฏูุฏูุด ูุฑุงุฏ,ุฃููุงุฏ ุฑุญููู,ุนูู ุนุจูุฏ,ุงุจู ุจุงุฏูุณ,ุจูู ุญููุฏุงู,ูุณุนูุฏ ุจูุฌุฑูู,ุงุจู ุฒูุงุฏ",
    "26": "ุงููุฏูุฉ,ุงูุจุฑูุงููุฉ,ูุตุฑ ุงูุจุฎุงุฑู,ุนูู ุจูุณูู,ุชุงุจูุงุท,ุจูู ุณูููุงู,ุงูุนูุงุฑูุฉ,ุดูุงูุฉ ุงูุนุฐุงูุฑุฉ,ุงูุณูุงูู,ุงูุดูุจูููุฉ,ูุฒุฑุฉ,ุณูุฏู ูุนูุงู,ุนุฒูุฒ,ุงูููุจ ุงููุจูุฑ,ุงูููููุจ",
    "27": "ูุณุชุบุงูู,ุนูู ุชุงุฏูุณ,ุจูููุฑุงุช,ุณูุฏู ุนูู,ุญุงุณู ููุงุด,ูุฒุบุฑุงู,ุฎูุฑ ุงูุฏูู,ุณูุฏู ูุฎุถุฑ,ุนุดุงุดุฉ,ุนูู ุงููููุตู,ุจู ุนุจุฏ ุงููุงูู ุฑูุถุงู,ูุฑูุงูุฉ,ุณุชูุฏูุฉ,ุงูุญุณูุงู,ูุงุฒููุฉ",
    "28": "ุงููุณููุฉ,ุจูุณุนุงุฏุฉ,ููุฑุฉ,ุฃููุงุฏ ุฏุฑุงุฌ,ุญููุงู ุงูุถูุนุฉ,ุณูุฏู ุนูุณู,ุนูู ุงูุญุฌู,ุจุฑููู,ุงูุดูุงู,ุนูู ุงูููุญ,ุจู ุณุฑูุฑ,ุงูุฌุฏู,ุณูุฏู ุนุงูุฑ,ุชุงูุณุฉ,ุฌุจู ูุณุงุนุฏ",
    "29": "ูุนุณูุฑ,ุณูู,ุชูุบููู,ุงููุญูุฏูุฉ,ุบุฑูุณ,ูุงุฏู ุงูุฃุจุทุงู,ุนูู ููุงู,ุจูุญููููุฉ,ุฒูุงูุฉ,ูุงุดู,ุนูุงุฒ,ุงููุทููุฑ,ุณูุฏู ุนุจุฏ ุงูุฌุจุงุฑ,ูุงุฏ ุชุงุบูุฉ,ูุทููุฑ,ูุงูุณุฉ",
    "30": "ูุฑููุฉ,ุชูุฑุช,ุงูุฑููุณุงุช,ุนูู ุงูุจูุถุงุก,ุณูุฏู ุฎูููุฏ,ุญุงุณู ูุณุนูุฏ,ุงูุทูุจุงุช,ุชูุงุณูู,ุงูููุงุฑูู,ุงูุญุฌูุฑุฉ,ุงููููุฑ,ุงูุจุฑูุฉ,ุญุงุณู ุจู ุนุจุฏ ุงููู",
    "31": "ููุฑุงู,ุจุฆุฑ ุงูุฌูุฑ,ุงูุณุงููุฉ,ุฃุฑุฒูู,ูุฏูู,ุจุทููุฉ,ุญุงุณู ุจูููู,ุญุงุณู ุจู ุนูุจุฉ,ุณูุฏู ุงูุดุญูู,ูุณุฑุบูู,ุงูุนูุตุฑ,ุจูุณูุฑ,ุนูู ุงูุชุฑู,ุงููุฑุณู,ุจูุชููููุณ,ูุงุฏู ุชูููุงุช,ุทุงูุฑุงูู,ุงููุฑูุฉ,ุงูุจุฑูุฉ",
    "32": "ุงูุจูุถ,ุจุฑูุฒููุฉ,ุจููุทุจ,ุงูุฃุจูุถ ุณูุฏู ุงูุดูุฎ,ุงูุฑูุงุตุฉ,ุงููุญุฑุฉ,ุจูุณูุบูู,ุงูุดูุงูุฉ,ุงููุงู ูุญูุฑ,ุงุณุชูุชู,ุณูุฏู ุทูููุฑ,ุณูุฏู ุงุนูุฑ",
    "33": "ุฅููุฒู,ุฌุงูุช,ุนูู ุฃูููุงุณ,ุจุฑุฌ ุงูุญูุงุณ,ุจุฑุฌ ุนูุฑ ุฅุฏุฑูุณ,ุฏุจุฏุงุจ",
    "34": "ุจุฑุฌ ุจูุนุฑูุฑูุฌ,ุฑุฃุณ ุงููุงุฏู,ุจุฑุฌ ุฒููุฑุฉ,ุงูููุตูุฑุฉ,ูุฌุงูุฉ,ุงูุญูุงุฏูุฉ,ุนูู ุชุงุบุฑูุช,ุจูุฑ ูุงุตุฏ ุนูู,ุฎููู,ุณูุฏู ูุจุงุฑู,ุงููุดูุฑ,ุญุณูุงูุฉ,ุงูููุฉ",
    "35": "ุจููุฑุฏุงุณ,ุจูุฏูุงู,ุฏูุณ,ุจุฑุฌ ููุงูู,ุฎููุณ ุงูุฎุดูุฉ,ูุณุฑ,ุงูุซููุฉ,ุฒููุฑู,ุฃููุงุฏ ููุณู,ุณู ูุตุทูู,ุชุฌูุงุจูู,ุดุนุจุช ุงูุนุงูุฑ,ุงููุงุตุฑูุฉ,ุจุบููุฉ,ููุฑุตู,ุญูุงุฏู",
    "36": "ุงูุทุงุฑู,ุงููุงูุฉ,ุจูุซูุฌุฉ,ุจู ูููุฏู,ุงูุฐุฑุนุงู,ุงูุจุณุจุงุณ,ุดุจูุทุฉ ูุฎุชุงุฑ,ุงูุนููู,ุฑุงููู,ุนุตููุฑ,ุฒุฑูุฒุฑ,ุนูู ุงูุนุณู,ุงูุณูุงุฑุฎ",
    "37": "ุชูุฏูู,ุฃู ุงูุนุณู",
    "38": "ุชูุณูุณููุช,ุซููุฉ ุงูุญุฏ,ุจุฑุฌ ุจููุนุงูุฉ,ุงูุฃุฒูุฑูุฉ,ูุฑุฌุงู,ุฎููุณุชู,ุงูุนููู,ุนูุงุฑู,ุณูุฏู ุนุงุจุฏ,ุจููุงูุฏ,ุจูู ุดุนูุจ,ุงูููุนุจ,ุณูุฏู ุจูุชุดูุช",
    "39": "ุงููุงุฏู,ุงููุบูุฑ,ุฌุงูุนุฉ,ููุงุฑ,ุงูุฑููุจุฉ,ุงูุฏุจููุฉ,ุงูุฑุจุงุญ,ุญุงุณู ุฎูููุฉ,ุงูุทุฑููุงูู,ุงูุจูุงุถุฉ,ุงููุฎูุฉ,ุงูุนููุฉ,ูุงุฏู ุงูุนููุฏุฉ,ุงููู ููุณุฉ",
    "40": "ุฎูุดูุฉ,ุดุดุงุฑ,ูุงูุณ,ุฃููุงุฏ ุฑุดุงุด,ุจุงุจุงุฑ,ุงููุญูู,ุนูู ุงูุทูููุฉ,ุจูุญูุงูุฉ,ุงูุญุงูุฉ,ุงูุฑูููุฉ,ุทุงูุฒุฉ,ุงูุณูุบุฉ,ุจุบุงู,ูุงุจูุณ",
    "41": "ุณูู ุฃูุฑุงุณ,ุณุฏุฑุงุชุฉ,ูุฏุงูุฑูุด,ุชุงูุฑุฉ,ุงูุญุฏุงุฏุฉ,ุงููุฑุงููุฉ,ุฃููุงุฏ ุฅุฏุฑูุณ,ุจุฆุฑ ุจูุญูุด,ุงููุดุฑูุญุฉ,ุฃู ุงูุนุธุงุฆู,ูููุงู,ุณูุฏู ูุฑุฌ",
    "42": "ุชูุจุงุฒุฉ,ุดุฑุดุงู,ุงููููุนุฉ,ุจูุงุณูุงุนูู,ููุฑุงูุฉ,ุงูุฏุงููุณ,ุญุฌูุท,ุณูุฏู ุงุนูุฑ,ูููุฉ,ุนูู ุชุงููุฑุงูุช,ุจููุงุฑูู,ุฎููุณุชู,ุงูุดุนูุจุฉ,ุฃุญูุฑ ุงูุนูู,ุจูุฑูููุฉ,ุณูุฏู ุฑุงุดุฏ,ููุงุตุฑ",
    "43": "ูููุฉ,ุดูุบูู ุงูุนูุฏ,ูุฑุฌููุฉ,ุชุงุฌูุงูุช,ุงูุชูุงุบูุฉ,ูุงุฏู ุงูุนุซูุงููุฉ,ุจูุญุงุชู,ุนูู ุงูุจูุถุงุก ุฃุญุฑูุด,ุณูุฏู ูุฑูุงู,ุงููุฑุงุฑู ูููุฉ,ุชุฑุนู ุจุงููุงู,ุฒุบุงูุฉ,ุงูุฑูุงุดุฏ",
    "44": "ุนูู ุงูุฏููู,ุฎููุณ ูููุงูุฉ,ูููุงูุฉ,ุงูุนุทุงู,ุงูุฑูููุฉ,ุฌูุฏู,ุจููุฏูุน,ุฌููุฏุฉ,ุจูุฑุงุดุฏ,ุงูุนุงูุฑุฉ,ุณูุฏู ูุฎุถุฑ,ุญูุงู ุฑูุบุฉ,ุนูู ุงูุชุฑูู,ุทุงุฑู ุจู ุฒูุงุฏ",
    "45": "ุงููุนุงูุฉ,ูุดุฑูุฉ,ุนูู ุงูุตูุฑุงุก,ุนุณูุฉ,ูุบุฑุงุฑ,ุฌูููู ุจูุฑุฒู,ุชููุช,ุณูุณููุฉ,ูููู ุจู ุนูุงุฑ,ุงููุตุฏูุฑ,ุงูุจููุถ",
    "46": "ุนูู ุชููุดูุช,ุญูุงู ุจูุญุฌุฑ,ุจูู ุตุงู,ุงููุงูุญ,ุนูู ุงูุฃุฑุจุนุงุก,ูููุงุตุฉ,ุดูุชูู,ุณูุฏู ุจู ุนุฏุฉ,ุชุงุฑูุฉ,ุงููุณุนูุฏ,ูุงุฏู ุงูุตุจุงุญ,ุนูู ุงูุทูุจุฉ",
    "47": "ุบุฑุฏุงูุฉ,ูุชูููู,ุงููุฑุงุฑุฉ,ุจุฑูุงู,ุถุงูุฉ ุจู ุถุญูุฉ,ุงูุนุทู,ุจูููุฑุฉ,ุฒููุงูุฉ,ุงูููุตูุฑุฉ,ุณุจุณุจ",
    "48": "ุบููุฒุงู,ูุงุฏู ุงุฑููู,ูุงุฒููุฉ,ุฒููุฑุฉ,ุนูู ููุณู,ููู,ุณูุฏู ุงูุญูุฏ ุจู ุนูู,ุฌุฏูููุฉ,ุงููุทูุฑ,ุงูุญูุงุฏูุฉ,ููุฏุงุณ,ุนูู ุทุงุฑู,ุงูุฑููุฉ",
    "49": "ุชูููููู,ุฃููุฑูุช,ุดุฑููู,ุทูููู,ูุตุฑ ูุฏูุฑ",
    "50": "ุจุฑุฌ ุจุงุฌู ูุฎุชุงุฑ,ุชูููุงููู",
    "51": "ุฃููุงุฏ ุฌูุงู,ุณูุฏู ุฎุงูุฏ,ุฑุฃุณ ุงูููุนุงุฏ,ุงูุจุณุจุงุณ,ุงูุฏูุณู,ุงูุดุนูุจูุฉ",
    "52": "ุจูู ุนุจุงุณ,ุงููุงุชุฉ,ููุฑุฒุงุฒ,ุฅููู,ุชุงูุชุฑุช,ุงููุตุงุจู,ุจูู ูุฎูู",
    "53": "ุนูู ุตุงูุญ,ููุงุฑุฉ ุงูุฒูู,ุฅููุบุฑ",
    "54": "ุนูู ูุฒุงู,ุชูู ุฒูุงุชูู",
    "55": "ุชูุฑุช,ุชูุงุณูู,ุงูููุงุฑูู,ุงููููุฑ,ุงูุทูุจุงุช,ุจู ูุงุตุฑ,ุงูุนุงููุฉ",
    "56": "ุฌุงูุช,ุจุฑุฌ ุงูุญูุงุณ",
    "57": "ุงููุบูุฑ,ุฌุงูุนุฉ,ุณูุฏู ุนูุฑุงู,ุณุทูู,ุฃู ุงูุทููุฑ,ุชูุฏูุฉ,ุงููุฑุงุฑุฉ",
    "58": "ุงููููุนุฉ,ุญุงุณู ุงููุงุฑุฉ,ุญุงุณู ููุญู",
    "59": "ุขููู,ุณุจูุงู,ุณูุฏู ุจูุฒูุฏ,ุงูุจูุถุงุก,ููุชุฉ ุณูุฏู ุณุนุฏ,ุจุฑูุฏุฉ,ุงูุญุงุฌ ูุดุฑู",
    "60": "ุงูุงุจูุถ ุณูุฏู ุงูุดูุฎ,ุงูุจููุฏ,ุฃุฑุจูุงุช,ุนูู ุงูุนุฑุงู",
    "61": "ุงูุนุฑูุดุฉ,ุงูููุฑ,ุณูุฏู ุฌููุงูู",
    "62": "ุงูููุทุฑุฉ,ุนูู ุฒุนุทูุท",
    "63": "ุจุฑููุฉ,ูุฏููุงู,ุจูุทุงู,ุนุฒูู ุนุจุฏ ุงููุงุฏุฑ",
    "64": "ุจูุณุนุงุฏุฉ,ุงููุงูู,ููุชุงู,ุจูู ูููุงู,ุณูุฏู ุนุงูุฑ",
    "65": "ุจุฆุฑ ุงูุนุงุชุฑ,ุนููุฉ ุงููุงูุญุฉ",
    "66": "ูุตุฑ ุงูุจุฎุงุฑู,ุงูููุชุงุญูุฉ,ุงูุณุงูู,ุนุฒูุฒ",
    "67": "ูุตุฑ ุงูุดูุงูุฉ,ุณุฑุบูู,ุฒูุงูุฉ ุงูุฃููุฑ ุนุจุฏ ุงููุงุฏุฑ",
    "68": "ุนูู ูุณุงุฑุฉ,ูุฑูููู,ุณูุฏู ูุนุฌุงู",
    "69": "ูุณุนุฏ,ุฏูุฏูู,ุณููุงูุฉ,ุณุฏ ุงูุฑุญุงู,ูุทุงุฑุฉ"
}

# --- 3. DATA PROCESSING ---
LOCATIONS_DATA = {}

def prepare_locations():
    """Converts the compressed raw string data into the list format needed for the dropdowns"""
    global LOCATIONS_DATA
    for code, name in WILAYAS.items():
        key = f"{code} - {name}"
        # Get communes from raw string, split by comma
        if code in RAW_COMMUNES:
            communes_list = RAW_COMMUNES[code].split(',')
            LOCATIONS_DATA[key] = sorted(communes_list)
        else:
            LOCATIONS_DATA[key] = [] # Should not happen as all are covered

prepare_locations()


# --- 4. FLASK APP & TEMPLATE ---
HTML_TEMPLATE = """
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุจููู ูููููุฑุช - ุทูุจ ุงูููุชุฌ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Cairo', 'sans-serif'] },
                    colors: {
                        brand: { light: '#FCE7F3', DEFAULT: '#EC4899', dark: '#831843', grey: '#374151' }
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-50 text-brand-grey font-sans antialiased">

    <nav class="bg-white shadow-sm py-4 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 flex justify-between items-center">
            <div class="text-2xl font-bold text-brand-dark tracking-tight flex items-center">
                <i class="fas fa-heart text-brand ml-2"></i>ComfortPad
            </div>
            <div class="text-sm font-semibold text-green-600 bg-green-50 px-3 py-1 rounded-full flex items-center">
                <i class="fas fa-shipping-fast ml-2"></i> ุชูุตูู 58 ููุงูุฉ
            </div>
        </div>
    </nav>

    <div class="max-w-7xl mx-auto px-4 py-8 md:py-12">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-start">
            
            <div class="space-y-8">
                <div class="rounded-3xl overflow-hidden shadow-lg border border-brand-light bg-white relative group">
                    <img src="https://placehold.co/800x800/FCE7F3/EC4899?text=Heating+Pad+Device" 
                         alt="ูุณุงุฏุฉ ุงูุชุฏูุฆุฉ" class="w-full h-auto transform transition hover:scale-105">
                    <div class="absolute bottom-4 right-4 bg-white/90 backdrop-blur px-4 py-2 rounded-lg text-sm font-bold text-brand-dark shadow-sm">
                        โญ 4.9/5
                    </div>
                </div>
                
                <div class="grid grid-cols-3 gap-4">
                    <div class="bg-white p-4 rounded-xl text-center shadow-sm border border-gray-100">
                        <div class="text-3xl text-brand mb-2"><i class="fas fa-wave-square"></i></div>
                        <h3 class="font-bold text-sm">ุงูุชุฒุงุฒ ูุชุฏููู</h3>
                    </div>
                    <div class="bg-white p-4 rounded-xl text-center shadow-sm border border-gray-100">
                        <div class="text-3xl text-brand mb-2"><i class="fas fa-temperature-high"></i></div>
                        <h3 class="font-bold text-sm">ุชุณุฎูู ููุฑู</h3>
                    </div>
                    <div class="bg-white p-4 rounded-xl text-center shadow-sm border border-gray-100">
                        <div class="text-3xl text-brand mb-2"><i class="fas fa-battery-full"></i></div>
                        <h3 class="font-bold text-sm">ุจุทุงุฑูุฉ ุทูููุฉ</h3>
                    </div>
                </div>
            </div>

            <div class="sticky top-24">
                <div class="bg-white rounded-2xl shadow-xl border border-brand-light p-6 md:p-8 relative">
                    <h2 class="text-2xl font-bold text-brand-dark mb-1">ุงุทูุจ ุงูุขู ูุงูุฏูุน ุนูุฏ ุงูุงุณุชูุงู</h2>
                    <p class="text-sm text-gray-500 mb-6">ุงููุฃ ุงููุนูููุงุช ุจุนูุงูุฉ ูุถูุงู ูุตูู ุงูุทูุจ.</p>

                    <form action="/order" method="POST" class="space-y-4">
                        
                        <div class="bg-brand-light/30 p-4 rounded-xl border border-brand-light mb-6">
                            <label class="flex items-center justify-between cursor-pointer mb-3">
                                <div class="flex items-center">
                                    <input type="radio" name="offer" value="1 Pack" class="w-5 h-5 text-brand focus:ring-brand" checked>
                                    <span class="mr-2 font-semibold">ุญุจุฉ ูุงุญุฏุฉ</span>
                                </div>
                                <span class="font-bold text-brand-dark">3,900 ุฏุฌ</span>
                            </label>
                            <hr class="border-brand-light my-2">
                            <label class="flex items-center justify-between cursor-pointer">
                                <div class="flex items-center">
                                    <input type="radio" name="offer" value="2 Packs" class="w-5 h-5 text-brand focus:ring-brand">
                                    <span class="mr-2 font-semibold">ุญุจุชูู (ุชุฎููุถ)</span>
                                </div>
                                <span class="font-bold text-brand-dark">6,500 ุฏุฌ</span>
                            </label>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">ุงูุงุณู ุงููุงูู</label>
                            <input type="text" name="fullname" required class="w-full px-4 py-3 rounded-lg border border-gray-200 focus:border-brand focus:ring-2 focus:ring-brand-light outline-none">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">ุฑูู ุงููุงุชู</label>
                            <input type="tel" name="phone" required dir="ltr" style="text-align:right" placeholder="05 XX XX XX XX" 
                                class="w-full px-4 py-3 rounded-lg border border-gray-200 focus:border-brand focus:ring-2 focus:ring-brand-light outline-none">
                        </div>

                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">ุงูููุงูุฉ</label>
                                <select id="wilaya" name="wilaya" onchange="loadCommunes()" required 
                                    class="w-full px-4 py-3 rounded-lg border border-gray-200 focus:border-brand bg-white">
                                    <option value="" disabled selected>ุงุฎุชุฑ ุงูููุงูุฉ</option>
                                    {% for wilaya_key in locations.keys() %}
                                    <option value="{{ wilaya_key }}">{{ wilaya_key }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">ุงูุจูุฏูุฉ</label>
                                <select id="commune" name="commune" required disabled 
                                    class="w-full px-4 py-3 rounded-lg border border-gray-200 focus:border-brand bg-white disabled:bg-gray-100 text-gray-500">
                                    <option value="">ุงุฎุชุฑ ุงูููุงูุฉ ุฃููุงู</option>
                                </select>
                            </div>
                        </div>

                        <button type="submit" class="w-full bg-brand hover:bg-brand-dark text-white font-bold py-4 rounded-xl shadow-lg mt-4 transition transform active:scale-95">
                            ุชุฃููุฏ ุงูุทูุจ
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script>
        const locations = {{ locations | tojson }};

        function loadCommunes() {
            const wilayaSelect = document.getElementById("wilaya");
            const communeSelect = document.getElementById("commune");
            const selectedWilaya = wilayaSelect.value;

            // Reset Commune Dropdown
            communeSelect.innerHTML = '<option value="">ุงุฎุชุฑ ุงูุจูุฏูุฉ</option>';
            communeSelect.disabled = false;
            communeSelect.classList.remove("text-gray-500");

            if (selectedWilaya && locations[selectedWilaya]) {
                // Populate Communes
                locations[selectedWilaya].sort().forEach(commune => {
                    const option = document.createElement("option");
                    option.value = commune;
                    option.text = commune;
                    communeSelect.appendChild(option);
                });
            } else {
                communeSelect.disabled = true;
            }
        }
    </script>
</body>
</html>
"""

@app.route('/', methods=['GET'])
def index():
    return render_template_string(HTML_TEMPLATE, locations=LOCATIONS_DATA)

@app.route('/order', methods=['POST'])
def order():
    data = request.form
    print(f"๐ฐ New Order: {data.get('fullname')} | {data.get('phone')} | {data.get('wilaya')} - {data.get('commune')}")
    
    return f"""
    <div dir="rtl" style="font-family: 'Cairo'; text-align: center; padding: 50px;">
        <h1 style="color: #EC4899;">ุดูุฑุงู ูู!</h1>
        <p>ุชู ุงุณุชูุงู ุทูุจู ุจูุฌุงุญ.</p>
        <p>ุณูุชุตู ุจู ุนูู ุงูุฑูู <strong>{data.get('phone')}</strong> ูุฑูุจุงู.</p>
        <a href="/">ุงูุนูุฏุฉ</a>
    </div>
    """

if __name__ == '__main__':
    import os
    # Get the PORT from Render, or use 4300 if running locally on your PC
    port = int(os.environ.get('PORT', 4300))
    # '0.0.0.0' is required for the server to be accessible externally
    app.run(debug=False, host='0.0.0.0', port=port)